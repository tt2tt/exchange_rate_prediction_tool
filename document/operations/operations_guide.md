# 運用ドキュメント

## ログ保守手順
- 保存先: `logs/` 配下に日付付きファイル（`run_YYYYMMDD_HHMM.txt`）が生成される。
- デフォルト保持期間は30日。自動ローテーションは設定済みだが、定期的に古いファイルが削除されているか確認する。
- 手動で削除する場合は、PowerShellで以下を実行する。
  ```powershell
  Get-ChildItem logs -File | Where-Object { $_.CreationTime -lt (Get-Date).AddDays(-30) } | Remove-Item
  ```
- ログは調査やレポート作成に備えて、必要に応じて外部ストレージへバックアップを取る。

## モデル更新手順
1. 最新データ（CSV形式）を準備し、必須カラム（Date, Open, High, Low, Close, MA5, MA25, MA75）が揃っていることを確認する。
2. アプリを起動して「学習データ」ボタンからCSVを選択する。
3. スプレッド設定が最新の取引条件に合致しているか見直す。
4. 「実行」ボタンで前処理→学習→評価→バックテスト→結果出力を実行する。
5. 処理完了後、`models/latest_model.joblib` が更新される。必要であれば日付版を別途保存する。
6. バックテスト結果CSVは `exports/` などのフォルダに保存されるため、業務システムやレポートへ転記する。
7. モデルをロールバックする必要がある場合は、旧バージョンの `joblib` ファイルを控えておく。

## バックテスト使用方法
1. アプリ実行後、自動的にバックテストまで処理が行われる。バックテスト結果はUIの「バックテスト結果」に要約が表示される。
2. 詳細なトレードログは出力されたCSVを確認する。損益列やエントリー／エグジット列を分析して改善施策を検討する。
3. バックテスト指標（勝率、プロフィットファクター、最大ドローダウン等）が目標基準を下回る場合は、特徴量や閾値の再設計を検討する。
4. 確認結果は必要に応じて運用レポートへ記録し、次回モデル更新の改善ポイントとして共有する。
